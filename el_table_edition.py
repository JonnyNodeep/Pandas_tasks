import pandas as pd  # Импортируем библиотеку pandas для работы с таблицами (DataFrame)
import os  # Импортируем модуль os для работы с файловой системой

# 1. Создаем словарь с данными для таблицы
# Ключи словаря — это названия столбцов, значения — это списки данных для каждого столбца
data = {
    'Наименование товара': ['Смартфон iPhone 13', 'Ноутбук Dell XPS 15', 'Наушники Sony WH-1000XM4',
                           'Планшет iPad Air', 'Smart TV Samsung', 'Умная колонка Amazon Alexa'],  # Названия товаров
    'Цена': [79990, 159990, 27990, 54990, 89990, 12990],  # Цены товаров
    'Остаток': [15, 8, 25, 12, 5, 20]  # Количество товаров на складе
}

# 2. Создаем DataFrame из словаря
# DataFrame — это табличная структура данных в pandas
df = pd.DataFrame(data)

# 3. Сортируем таблицу по столбцу "Цена" в порядке возрастания
# Метод sort_values() сортирует строки таблицы по указанному столбцу
# Параметр by='Цена' указывает, что сортировка выполняется по столбцу "Цена"
# Метод reset_index(drop=True) сбрасывает индексы после сортировки, чтобы они шли по порядку
df_sorted = df.sort_values(by='Цена').reset_index(drop=True)

# 4. Сохраняем отсортированную таблицу в файл Excel
# Метод to_excel() сохраняет DataFrame в формате Excel
# Параметр index=False указывает, что индексы строк не нужно сохранять в файл
# Указываем полный путь, куда будет сохранен файл
df_sorted.to_excel('C:/Users/89638/OneDrive/Рабочий стол/Prompt Engineer/Pandas/electronics_store.xlsx', index=False)

# 5. Выводим сообщение о том, что файл успешно сохранен
print("Файл сохранен как 'electronics_store.xlsx'")

# 6. Проверяем, что файл был успешно создан
# Метод os.path.exists() проверяет, существует ли файл по указанному пути
if os.path.exists('C:/Users/89638/OneDrive/Рабочий стол/Prompt Engineer/Pandas/electronics_store.xlsx'):
    print("Файл успешно создан!")  # Выводим сообщение, если файл существует
    # Метод os.path.abspath() возвращает абсолютный путь к файлу
    print("Путь к файлу:", os.path.abspath('C:/Users/89638/OneDrive/Рабочий стол/Prompt Engineer/Pandas/electronics_store.xlsx'))